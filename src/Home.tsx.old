import React, {
  useState,
  useEffect,
  useCallback,
  Fragment,
  useRef,
} from "react";
import styled from "styled-components";
import { Transition } from "react-transition-group";

export const Home = () => {
  const [inProp, setInProp] = useState(false);
  const [openingTitleStage, setOpeningTitleStage] = useState<number>(0);
  useEffect(() => {
    setTimeout(() => {
      setInProp(true);
    }, 1000);
  });

  const Stage1 = () => (
  );

  return <HomeContainer>{<Stage1 />}</HomeContainer>;
};

const Text = styled.div`
  font-size: 1.8rem;
  margin: 0.5rem;
`;

const HomeContainer = styled.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
`;

const Fade = styled.div`
  transition: 0.5s;
  opacity: ${(props: { state: any }) => (props.state === "entered" ? 1 : 0)};
`;

type PropsType = {
  children: JSX.Element[];
  onFinish: () => void;
};

const ShowTextWithStyle = ({ children, onFinish }: PropsType) => {
  const [childCount, setChildCount] = useState<number>(0);
  const [tickingClock, setTickingClock] = useState<any>();
  const [visibleChildren, setVisibleChildren] = useState(
    Array(children.length).fill(false) // the indexes represent each child, the value: whether it's visible.
  );

  useEffect(() => {
    setChildCount(0);
    setVisibleChildren(
      Array(children.length).fill(false) // the indexes represent each child, the value: whether it's visible.
    );
  }, [children]);

  useEffect(() => {
    if (childCount > children.length) return;
    setTimeout(() => {
      visibleChildren[childCount] = true;
      setVisibleChildren([...visibleChildren]);
      setChildCount(childCount + 1);
    }, 2000);
  }, [childCount, children]);

  const childs = children.map((C, idx) => {
    return (
      <Transition in={visibleChildren[idx]} timeout={0} key={idx}>
        {(state) => <Fade state={state}>{React.cloneElement(C)}</Fade>}
      </Transition>
    );
  });

  return <Fragment>{childs}</Fragment>;
};

const Container = styled.div``;
